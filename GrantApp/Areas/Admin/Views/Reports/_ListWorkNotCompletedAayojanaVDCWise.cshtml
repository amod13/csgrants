@model GrantApp.Models.ApplicationCompletionStatusVM
@{
    int SN = 1;

}
<div class="table-responsive" style="margin-top:50px;">
    <table class="table table-bordered cell-border" id="droppedAayojanaTable">
        <thead>
            <tr>
                <th>क्रस</th>
                <th>शुरु आ.व.</th>
                <th>अनुदान प्रकार</th>
                <th>प्रदेश</th>
                <th>जिल्ला</th>
                <th>कार्यालय</th>
                <th>आयोजना/कार्यक्रम</th>
                <th>कुल लागत</th>
                <th>आयोजना सम्पन्न हुने नयाँ अवधि</th>
                <th>थप रकम माग(लाखमा)</th>
                <th>कारण(पुस्ट्याई, निर्णय र आधार सहितको आधिकारिक पत्र)</th>



            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.ApplicationCompletionStatusVMList)
            {
                if (item.TotalBudget.HasValue)
                {
                    if (item.TotalBudget > 0)
                    {
                        item.TotalBudget = item.TotalBudget / 100000;
                    }
                }
                string FullOrPartialText = @"आंशिक सम्पन्न";
                if (item.CompleteOrParitalCompleteStatusId == 1)
                {
                    FullOrPartialText = @"पूर्ण सम्पन्न";
                }
                <tr>
                    <td>@SN</td>
                    <td>@item.PhaseTitle</td>
                    <td>@item.GrantTypeName</td>

                    <td>@item.ProvinceTitleNep</td>
                    <td>@item.DistrictNameNep</td>
                    <td>@item.OfficeName</td>
                    <td>@item.SubProgramTitle</td>
                    <td>@item.TotalBudget</td>
                    <td>@item.YearNeededForCompleteId</td>
                    <td>@item.AmountRequired</td>
                    <td>
                        @if (item.NotCompletedFileTypeStr != "")
                        {
                            @Html.ActionLink(" Download", "Download", "GrantRequestForm", new { @FileName = item.NotCompletedFileTypeStr }, new { @class = "fa fa-download" })

                        }
                        else
                        {

                        }
                    </td>



                </tr>
                SN++;
            }

        </tbody>
    </table>
</div>
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script src="~/AdminResources/DataTables/datatables.min.js"></script>
<script src="~/AdminResources/DataTables/Buttons-2.3.6/js/buttons.colVis.js"></script>
<script>

    var dtjquery = $.noConflict();
    dtjquery(document).ready(function () {
        dtjquery('#droppedAayojanaTable').DataTable({
            pageLength: 100,
            dom: 'Bfrtip',
            buttons: [

                {
                    extend: 'excelHtml5',
                    title: 'ReportsCompletedAayojana',
                    exportOptions: {
                        columns: ':visible'
                    }
                },

                //'colvis'
            ]
        });
    });



</script>